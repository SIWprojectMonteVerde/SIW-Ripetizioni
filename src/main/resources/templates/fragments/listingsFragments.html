<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>

<body>
<div th:fragment="formAnnuncio(btnText,action)" class="container">
  <form id="formAnnuncio" th:action="@{'/teacher/'+${action}}" th:object="${listing}" method="post">
    <input type="hidden" th:field="*{id}" />
    <div class="mb-3">
      <label for="titleInput" class="form-label">Titolo</label>
      <input type="text" id="titleInput" name="titolo" class="form-control" th:field="*{title}" required>
    </div>
    <div class="mb-3">
      <label for="descriptionInput" class="form-label">Descrizione</label>
      <textarea id="descriptionInput" name="descrizione" class="form-control" rows="3" th:field="*{description}"
                required></textarea>
    </div>
    <div class="mb-3">
      <label for="materiaSelect" class="form-label">Materia</label>
      <select id="materiaSelect" name="subject" class="form-select" th:field="*{subject}" required>
        <option value="">Seleziona una materia</option>
        <option th:each="subject : ${subjects}" th:value="${subject.id}" th:text="${subject.name}"></option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label" for="priceInput">Prezzo orario</label>
      <input type="number" id="priceInput" class="form-control" th:field="*{hourlyRate}" required>
    </div>


  </form>
  <div class="row mt-3 align-items-center">
    <div class="col">
      <h2> Disponibilt√†</h2>
    </div>
    <div class="col text-end">
      <a id="addAnnuncioBtn" class="btn btn-success" href="#" onclick="addAvailability()">
        <i class="bi bi-plus-circle-fill"></i>
      </a>
    </div>

  </div>
  <div class="overflow-x-auto py-3">
    <div class="d-flex gap-3" style="width: max-content;">
      <div th:each="availability,iterStat : ${listing.availability}" class="flex-shrink-0">
        <!--OTTENGO INDICI DELLA LISTA PER LA RIMOZIONE-->
        <div class="card h-100 position-relative">
          <div class="card-body">
            <a class="btn btn-sm btn-danger position-absolute bg-danger border-0 rounded-circle p-1"
               style="top: -7px; right: -7px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;"
               href="#" th:onclick="|removeAvailability(${iterStat.index})|">
              <!---INCLUDO L'INDICE NELL REF-->
              <i class="bi bi-x-lg text-white" style="font-size: 12px;"></i>
            </a>
            <h5 class="card-title" th:text="${#temporals.format(availability.startTime, 'EEEE')}">Giorno</h5>
            <p class="card-text"
               th:text="${#temporals.format(availability.startTime, 'HH:mm')} + ' - ' + ${#temporals.format(availability.endTime, 'HH:mm')}">
              Orario</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div>
    <button form="formAnnuncio" type="submit" class="btn btn-primary">
      <span th:text="${btnText}">Bottone Salvataggio <i class="bi bi-floppy me-2"></i></span>
    </button>
  </div>

</div>


</body>

</html>